# Git の使い方ガイドライン

(2023年 TNP全体で共同制作をしませんかプロジェクト2023 を一部再利用、改変しています)

## もくじ

- [Git の使い方ガイドライン](#git-の使い方ガイドライン)
  - [概要: タスクのこなし方](#概要-タスクのこなし方)
  - [機能の追加と修正の前にはブランチを作成する](#機能の追加と修正の前にはブランチを作成する)
  - [ブランチでの作業が終わったら Pull Request を作成する](#ブランチでの作業が終わったら-pull-request-を作成する)
  - [Commit するときの注意](#commit-するときの注意)
    - [コミットのタイトル(Summary)は英語で書く](#コミットのタイトルsummaryは英語で書く)
    - [コミットの説明(Description)は日本語でも英語でもよい](#コミットの説明descriptionは日本語でも英語でもよい)
  - [ブランチは作業ごとに新しいものを作成する](#ブランチは作業ごとに新しいものを作成する)
  - [ブランチの名前はルールに従うこと](#ブランチの名前はルールに従うこと)
    - [機能を追加するとき](#機能を追加するとき)
    - [既存の機能に追記・修正を加えるとき](#既存の機能に追記修正を加えるとき)
    - [バグを修正するとき](#バグを修正するとき)

## 概要: タスクのこなし方

1. 作業を開始する前には Projects に対応するタスクを追加し、そのタスクの issue を立てる
2. タスクの「進行状況」を変更する
3. [ブランチの名前はルールに従うこと](#ブランチの名前はルールに従うこと) に従い命名し、新しいブランチを切る
4. あなたの変更を commit & push (2人以上なら push 前に fetch & pull をお忘れなく)
5. Step 3 で作成したブランチから `main` ブランチに対して、Pull Request を書く
6. レビューを待ち、Approve が十分得られたら作成者が Merge する

## 機能の追加と修正の前にはブランチを作成する

新たな機能を追加したり、問題を修正したりする場合においては、集中的にタスクを管理するために Projects にタスクと Issue を作成して、また新たなブランチを作成したのち、そのブランチで作業を行ってください。
以下に、その手順を示します。

1. 追加や修正したい機能について、Projects からタスクを追加します。
    1. この repo の **Projects** タブから **TNP Coop 2023** をクリックします。
    2. ``You can use Control + Space to add an item`` をクリックすると、タスクの名前を入力することができます。ここに、あなたが追加・修正したい機能についての概要を記入して Enter を押してください。
2. Issue をタスクに関連付けて作成します。(ブランチを関連付けるためです)
    1. ページの下の方の ``Convert to issue`` を見つけてクリックします。
    2. Issue が追加され、タスクに関連付けられます。
    3. 続いて、``Assignees`` (タスクを割り当てる対象)、 ``Labels`` (タスクの種類)、``Status`` (タスクの作業状況)、その他タスクの説明について、必要に応じて記入してください。
    4. 記入が十分なら、``Open in new tab`` から Issue のページに移動してください。
3. Issue に関連付けたブランチを作成します。
    1. ページの右方に、``Assignees`` や ``Labels`` などがありますが、その下に ``Development`` ``Create a branch`` があります。ここをクリックすると、ブランチを作成できます。
    2. ブランチの名前を入力します。ブランチの名前は、[ブランチの名前はルールに従うこと](#ブランチの名前はルールに従うこと) を参照して決めてください。
    3. ``Create branch`` を押します。

これで、作業を行うブランチの作成が完了しました。いつも通り作業を行ってください。

## ブランチでの作業が終わったら Pull Request を作成する

ブランチでの作業が終了したら、main ブランチやあるいはその他対応するブランチに作業内容を反映する(merge する)必要があります。しかし、これをブランチを作成した個人の判断で行うと、ほかの作業者にとって予期しないコードの変更が発生する可能性があります。そのため、Pull Request を作成してから merge を行います。
また、Pull Request が受理されると、タスクを作成する際に一緒に作成した Issue が自動的に解決され、タスクが自動的に完了されたとしてマークされます。

ブランチでの作業が終了したら、以下を行ってください。

1. 必要に応じ、``git pull`` で他人の作業を取り込む
2. 必ず ``git commit`` と ``git push`` を行い、作業内容の反映を行う (Desktop の方は Sync でかまいません)
3. GitHub から Pull Requests を開き、``New pull request`` を押して Pull Request を作成します。Conflict が発生していればWebで修正することも、またmainブランチを作業中のブランチにmergeすることでも同様にconflictを解消できます。9999
4. ``base:`` には merge 先のブランチを、``compare:`` には merge 元のブランチを指定します。たいていの場合、前者は ``develop``、後者はあなたが作成したブランチが入ります。
5. Pull request の詳細を記入します。ブランチで行った変更について、具体的に記入してください。
6. 詳細の記入が終わったら、この詳細の最後にあなたが作成したブランチに関連付けられた Issue の番号を使って、``This pull request will close #3`` のように一文を追記してください。[Pull RequestをIssueにリンクする](https://docs.github.com/ja/issues/tracking-your-work-with-issues/linking-a-pull-request-to-an-issue) を参考に、追記すべき文章を改変してもかまいません。
7. 記入が終わったら、``Create pull request`` を押して Pull Request を作成してください。
8. 作成した Pull Request が受理(Approve)されるまで待ってください。必要に応じて自ら merge することも可能ですが、推奨されません。

## Commit するときの注意

### コミットのタイトル(Summary)は英語で書く

コミットの概要を示す「タイトル」は、可能な限り簡潔な英語で記述してください。
略語は WIP 避けてください。

なお、コミットのタイトルは GitHub Desktop では ``Summary`` と書いてある欄をさします。
あるいは、Visual Studio Code などのエディタではコミットメッセージの最初の行をさすこともあります。

### コミットの説明(Description)は日本語でも英語でもよい

コミットの内容を示す「説明」には、日本語と英語のどちらを使ってもかまいません。ただし、必要な場合を除き、1つのコミットメッセージに両方の言語を混在させることは避けてください。

なお、コミットのタイトルは GitHub Desktop では ``Description`` と書いてある欄をさします。
あるいは、Visual Studio Code などのエディタではコミットメッセージの2行目以降をさすこともあります。

## ブランチは作業ごとに新しいものを作成する

main ブランチへの頻繁なコミットによる競合を防ぐため、またレビューを容易にする目的があります。
作成するブランチの名前は、[ブランチの名前はルールに従うこと](#ブランチの名前はルールに従うこと) を参照して作成してください。
※ なお、機能の追加や修正のためにブランチを作成する場合は [ブランチの名前はルールに従うこと](#ブランチの名前はルールに従うこと) の手順に従ってブランチを作成してください。

## ブランチの名前はルールに従うこと

作成するブランチの名前は、基本的には以下に記述するルールに従ってください。
なお、``[機能名]`` のように、角カッコ ``[]`` とそれらに囲まれた部分については、角カッコ内の説明をもとに、**角カッコごと**置き換えてください。詳しくは、各シチュエーションの例を見てください。
``[YYYYmmdd]`` とは、開発を開始した(ブランチを作成した)日付を、年4桁、月2桁、日2桁の合計8桁で記述することを指します。不足している桁は ``0`` で埋めます。
ブランチ名には日本語を使用することも可能ですが、できる限りアルファベットや数字、``.-_/`` の記号のみを使うことを強く推奨します。

### 機能を追加するとき

プロジェクトに新たな機能を追加する場合は、以下のような形式でブランチの名前を決めてください。

```plaintext
feature/[機能名]/[YYYYmmdd]
```

例:
2023年8月25日に、「新しい敵である _Powered Sorcery_ を追加したよ」という場合は、以下のように書くことができます。

```plaintext
feature/new_enemy_powered_sorcery/20230825
```

なお、``[機能名]`` は簡潔な英語で記述してください。説明が難しい場合にはローマ字でもかまいません。

### 既存の機能に追記・修正を加えるとき

プロジェクトにすでに存在している機能に変更を加える場合は、以下のような形式でブランチの名前を決めてください。

```plaintext
enhancement/[機能名]/[YYYYmmdd]
```

例:
2023年8月27日に、「_Powered Sorcery_ に機能を追加するよ」という場合は、以下のように書くことができます。

```plaintext
enhancement/powered_sorcery/20230825
```

``[機能名]`` は、``features/`` 以下にあるブランチの機能名と必ずしも一致する必要はありませんが、対応づけが容易にできるような名前にすることが推奨されます。

なお、``[機能名]`` は簡潔な英語で記述してください。説明が難しい場合にはローマ字でもかまいません。

### バグを修正するとき

プロジェクトに発生したバグを修正する場合は、以下のような形式でブランチの名前を決めてください。

```plaintext
bugfix/[機能名]/[YYYYmmdd]
```

例:
2023年8月28日に、「属性ダメージの計算式を修正したよ」という場合は、以下のように書くことができます。

```plaintext
bugfix/fix_element_damage_calculation/20230828
```

なお、``[機能名]`` は簡潔な英語で記述してください。説明が難しい場合にはローマ字でもかまいません。
